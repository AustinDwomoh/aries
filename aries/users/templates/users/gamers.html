{% extends "base.html" %}
{% load static %}
{% block title %} Gamers {% endblock title %}
{% block content %}
<div class="container">
    <div class="row align-items-center"> 
        <form method="GET" action="{% url 'gamers' %}" class="mb-4 d-flex justify-content-center">
            <input type="text" name="q" class="form-control w-50" placeholder="Search for a player..." value="{{ query }}">
            <button type="submit" class="btn btn-primary mx-2">Search</button>
        </form>
    </div>
    {% if no_results %}
        <div class="alert alert-warning text-center" role="alert">
        No players found for "{{ query }}". Please try a different search term.
        </div>
    {% endif %}
</div>
<div class="row">
    {% for player_data in players %}
    <div class="col-md-4" data-aos="fade-right" data-aos-delay="{{ forloop.counter0|add:"0" }}00">
        <!-- Player Card -->
        <a href="{% url 'player_details' player_data.player.id %}">
            <div class="card my-3 rounded-3 shadow" >
                <div class="card-body text-center  rounded-3" style="background-image: url('{{ player_data.background_image }}');background-size: cover; background-position: center;text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);color:white">
                <!-- Avatar -->
                <div class="rounded-3 " style="position: absolute; top: 0; right: 0; bottom: 0; left: 0; background: rgba(0,0,0,0.5); z-index: 1;"></div>
                <div  style="position: relative; z-index: 2;">
                {% if player_data.player.profile.profile_picture %}
                <img src="{{ player_data.player.profile.profile_picture.url }}" alt="{{ player_data.player.username }}'s avatar" class="img-fluid rounded-circle mb-3" style="width: 100px; height: 100px;" loading="lazy">
                {% endif %}

                <!-- Player Name -->
                <h5 class="card-title">{{ player_data.player.username }}</h5>
                {% if  player_data.player.profile.clan%}
                    <p>{{ player_data.player.profile.clan.clan_name }} </p>
                {% else %}
                    <p >Clanless</p>
                {% endif %}
                
                {% if player_data.match_results %}
                    <p>
                        {% for result in player_data.match_results %}
                            <span class="badge {% if result == 'W' %}bg-success{% elif result == 'L' %}bg-danger{% else %}bg-warning{% endif %}">
                                {% if result == 'W' %}
                                    W
                                {% elif result == 'L' %}
                                    L
                                {% else %}
                                    D
                                {% endif %}
                            </span>
                        {% endfor %}
                    </p>
                {% else %}
                    <p>No recent matches</p>
                {% endif %}
                
                
                <div class="d-flex justify-content-between text-center ">
                    <div class="mx-2">
                        <p class="mb-1 h6 text-primary">{{ player_data.player.profile.stats.win_rate }}%</p>
                        <p class="small  mb-0">Win Rate</p>
                    </div>
                    <div class="mx-2">
                        <p class="mb-1 h6 text-success">{{ player_data.player.profile.stats.total_matches }}</p>
                        <p class="small  mb-0">Matches</p>
                    </div>
                    <div class="mx-2">
                        <p class="mb-1 h6 text-warning">{{ player_data.player.profile.stats.rank }}</p>
                        <p class="small  mb-0">Rank</p>
                    </div>
                </div>
                </div>
                </div>
            </div>
        </a>
    </div>
    {% endfor %}
</div>

</div>

{% endblock content %}

